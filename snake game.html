<!DOCTYPE html>
<html>
  <head>
    <style>
    .thegame {
    border: 1px solid black;
    width: 400px;
    height: 400px;
    }
    </style>
  </head>
<body>

<canvas id="snakegame" class="thegame" >
Your browser does not support the HTML canvas tag.</canvas>
<p id="test">debug stuff</p>
<p id="test2">text</p>
<button id="thingbutton">text</button>
<script>
document.getElementById("thingbutton").addEventListener("click", everything);
function everything () {
const game = {canvas: document.getElementById("snakegame"), x: document.getElementById("snakegame").width, y: document.getElementById("snakegame").height};
document.getElementById("test2").innerHTML= `<p> ${game.x} </p>`;
let crayon = game.canvas.getContext('2d');
let snake = {x: 0, y: 0, width: game.x / 20, height: game.y /20};
let direction = "right";
let snake_body = []
window.addEventListener('keydown', function(event) {
  if (event.key === 'ArrowDown') {
    direction = 'down';
  }
  if (event.key === 'ArrowRight') {
    direction = 'right'
  }
  if (event.key === 'ArrowLeft') {
    direction = 'left';
  }
  if (event.key=== 'ArrowUp') {
    direction = 'up';
  } 
});
let temp = {x: 0, y: 0};
function move() {
  temp.x = snake.x;
  temp.y = snake.y;
crayon.clearRect(snake.x, snake.y, snake.width +1, snake.height + 1);
crayon.fillStyle = 'blue';

if (direction === 'left') {
  snake.x = snake.x - snake.width;
} else if(direction === 'right') {
  snake.x = snake.x + snake.width;
} else if (direction === 'up') {
  snake.y = snake.y - snake.height;
} else if (direction==='down') {
  snake.y = snake.y + snake.height;
}
crayon.fillRect(snake.x, snake.y, snake.width, snake.height);
document.getElementById("test").innerHTML = `<p> direction: ${direction} x: ${snake.x} y: ${snake.y}</p>`;
};

function on_food() {
  let place;
if (snake_body.length > 0) {
  place = snake_body.length;
} else {
  place = 0;
}
  if (direction === 'left') {
  snake_body[place] = {x: snake.x + snake.width, y: snake.y, direction: direction}
} else if(direction === 'right') {
  snake_body[place] = {x: snake.x - snake.width, y: snake.y, direction: direction}
} else if (direction === 'up') {
  snake_body[place] = {x: snake.x, y: snake.y - snake.height, direction: direction}
} else if (direction==='down') {
  snake_body[place] = {x: snake.x , y: snake.y + snake.height, direction: direction}
}
spawn_food();
}
let next_color = 0;
function move_body () {
  if (snake_body.length === 0) {
    return
  } else {
    crayon.clearRect(snake_body[snake_body.length - 1].x,snake_body[snake_body.length - 1].y, snake.width + 2, snake.height + 2); 
    snake_body[snake_body.length - 1] = {x: temp.x, y: temp.y};
    if (next_color ==0) {
      crayon.fillStyle = 'green';
      next_color++;
    } else {
      next_color --
      crayon.fillStyle = 'red';
    }
    crayon.fillRect(temp.x, temp.y, snake.width, snake.height);
    let last_to_first = snake_body.pop();
    snake_body.unshift(last_to_first);
  }}
function death_message() {
  document.getElementById("test").innerHTML = `<p> you dead bruh </p>`;
}

function on_death () {
   death_message();
  clearInterval(x);
}
function check_for_colisions() {
  if (snake.x == game.x || snake.y == game.y || snake.x <0 || snake.y < 0) {
    on_death();
  } else {
    check_food();
  }
};
let food = {x: 0, y: 0, width: game.x /20, height: game.y / 20};


function spawn_food() {
  crayon.fillStyle= 'green';
  food.x = (Math.floor(Math.random()* 20) * food.width);
  food.y = (Math.floor(Math.random()* 20) * food.height);
  crayon.fillRect(food.x, food.y, food.width, food.height);
}
function check_food() {
  if (snake.x == food.x && snake.y == food.y) {
    on_food();
  }
}
spawn_food();
function start() {
  move();
  check_for_colisions();
  move_body();
}

let x = setInterval(start, 200);
document.getElementById("test").innerHTML = `<p> snake x: ${snake.x}  </p>`;
}
</script>

</body>
</html>
